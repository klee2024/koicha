<ng-container *ngIf="productCardVisible">
  <div
    [ngClass]="
      variant === 'review'
        ? 'product-card-main rounded-[10px] bg-white/80 p-6 backdrop-blur'
        : 'product-card-main relative overflow-hidden rounded-[10px]'
    "
  >
    <ng-container>
      <ng-container *ngIf="variant != 'review'">
        <img
          [src]="imageUrl"
          id="product-image"
          alt="{{ name }}"
          class="block h-full w-full object-cover"
        />
      </ng-container>

      <div class="absolute inset-0 flex flex-col justify-between">
        <ng-container class="ranking-and-buttons" *ngIf="variant != 'review'">
          <!--only show top buttons if not a review card-->
          <div class="flex items-start justify-between gap-2 p-4">
            <ng-container [ngSwitch]="variant">
              <ng-container *ngSwitchCase="'rating'">
                <span>#{{ id }}</span>
              </ng-container>
              <ng-container *ngSwitchDefault> <div></div></ng-container>
              <!--empty div to retain formatting-->
            </ng-container>

            <div class="product-card-buttons flex gap-2">
              <button
                class="bookmark rounded-full bg-white/80 px-3 py-1 text-xs uppercase tracking-wide text-black backdrop-blur"
                (click)="addToBookmarks(id)"
              >
                bookmark
              </button>
              <!-- TODO: update with appropriate symbols -->
              <button
                class="userReview rounded-full bg-white/80 px-3 py-1 text-xs text-black backdrop-blur"
                (click)="reviewProduct('placeholder user', id)"
              >
                <3
              </button>
              <!-- TODO: update with appropriate symbols -->
            </div>
          </div>
        </ng-container>
        <ng-container class="product-card-content">
          <div class="bg-white/80 px-5 pb-5 pt-4 backdrop-blur">
            <div class="flex items-center justify-between">
              <a
                [href]="productUrl"
                class="product-name-link font-mono text-lg font-medium"
                target="_blank"
                rel="noopener noreferrer"
                >{{ name }}</a
              >
              <span class="product-brand font-mono text-lg">{{ brand }}</span>
            </div>
            <span
              class="product-preparation block pt-2 font-sans text-xs uppercase tracking-[0.3em]"
              [id]="preparation.id"
            >
              {{ preparation.name }}
            </span>
            <div class="flex items-end justify-between pt-4">
              <div class="product-tagSlugs">
                <ul
                  class="product-tagSlugs-list flex flex-wrap gap-3 font-mono text-xs lowercase"
                >
                  <li
                    *ngFor="let tag of tags; trackBy: trackById"
                    [id]="tag.id"
                  >
                    {{ tag.label }}
                  </li>
                </ul>
              </div>
              <div class="recommendation-or-ratingpercent font-mono text-xs">
                <ng-container [ngSwitch]="variant">
                  <ng-container *ngSwitchCase="'rating'">
                    <!-- TODO: make this dynamic -->
                    <span class="font-medium"> Rating: 8.6 </span>
                  </ng-container>
                  <ng-container *ngSwitchDefault>
                    <ng-container *ngIf="matchPercentage !== undefined">
                      {{ matchPercentage }}% match
                    </ng-container>
                  </ng-container>
                </ng-container>
              </div>
            </div>
          </div>
        </ng-container>
        <ng-container class="user-review" *ngIf="variant == 'review'">
          <div class="flex-col">
            <span class="font-mono font-medium flex">Review:</span>
            <!-- TODO: make this dynamic -->
            <p class="flex font-sans">
              Rich umami with a pleasant cocoa note. Smooth and balanced.
            </p>
          </div>
        </ng-container>
      </div>
    </ng-container>
  </div></ng-container
>
