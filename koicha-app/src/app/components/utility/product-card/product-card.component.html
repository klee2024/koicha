<ng-container *ngIf="productCardData as card">
  <div
    class="product-card-main relative overflow-hidden rounded-[10px] aspect-[1/1]"
    (click)="card.variant === 'review' && reviewSelected.emit(card)"
  >
    <!-- TODO: make a default image in case the image does not load for the product -->
    <img
      [src]="card.image_url"
      id="product-image"
      [alt]="card.name"
      class="block h-full w-full object-cover"
    />
    <div class="absolute inset-0 flex flex-col justify-between">
      <div class="flex items-start justify-between gap-2 p-4">
        <div class="exit-button" *ngIf="exit">
          <button
            id="close-product-card"
            class="rounded-full bg-white/80 px-2 py-1 text-xs uppercase tracking-wide text-black backdrop-blur"
          >
            close
          </button>
        </div>
        <div
          *ngIf="card.variant === 'review' && productUserRanking != undefined"
          class="flex h-8 w-8 items-center justify-center rounded-full bg-white/25 font-sans text-sm font-medium backdrop-blur"
        >
          {{ productUserRanking + 1 }}
        </div>
        <div></div>
        <!--empty div for styling purposes-->
        <div class="product-card-buttons flex gap-3">
          <button
            class="bookmark flex items-center gap-2 rounded-full bg-white/90 px-4 py-2 text-sm uppercase tracking-wide text-neutral-800 backdrop-blur border border-black/10 shadow-sm"
            (click)="$event.stopPropagation(); productToBookmark.emit(card)"
          >
            <ng-container *ngIf="card.bookmarked; else outlineBookmark">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
                class="h-4 w-4"
                aria-hidden="true"
              >
                <path
                  fill-rule="evenodd"
                  d="M6.32 2.577a49.255 49.255 0 0 1 11.36 0c1.497.174 2.57 1.46 2.57 2.93V21a.75.75 0 0 1-1.085.67L12 18.089l-7.165 3.583A.75.75 0 0 1 3.75 21V5.507c0-1.47 1.073-2.756 2.57-2.93Z"
                  clip-rule="evenodd"
                />
              </svg>
            </ng-container>
            <ng-template #outlineBookmark>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="1.5"
                class="h-4 w-4"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z"
                />
              </svg>
            </ng-template>
          </button>
          <button
            class="userReview flex items-center gap-2 rounded-full bg-white/90 px-4 py-2 text-sm uppercase tracking-wide text-neutral-800 backdrop-blur border border-black/10 shadow-sm disabled:cursor-not-allowed disabled:opacity-50"
            (click)="$event.stopPropagation(); productToReview.emit(card)"
            [disabled]="card.reviewed"
          >
            <ng-container *ngIf="card.reviewed; else outlineReview">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
                class="h-4 w-4"
                aria-hidden="true"
              >
                <path
                  fill-rule="evenodd"
                  d="M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-1.207Z"
                  clip-rule="evenodd"
                />
              </svg>
            </ng-container>
            <ng-template #outlineReview>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="h-4 w-4"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M12 4.5v15m7.5-7.5h-15"
                />
              </svg>
            </ng-template>
          </button>
        </div>
      </div>

      <app-product-card-content
        [productCardData]="card"
      ></app-product-card-content>
    </div>
  </div>
</ng-container>
